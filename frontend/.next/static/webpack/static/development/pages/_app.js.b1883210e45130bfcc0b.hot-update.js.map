{"version":3,"file":"static/webpack/static/development/pages/_app.js.b1883210e45130bfcc0b.hot-update.js","sources":["webpack:///./components/Search.js"],"sourcesContent":["import React from 'react';\nimport Downshift, { resetIdCounter } from 'downshift';\nimport Router from 'next/router';\nimport debounce from 'lodash.debounce';\nimport { ApolloConsumer } from 'react-apollo';\nimport { DropDown, DropDownItem, SearchStyles } from './styles/DropDown';\nimport { SEARCH_ITEMS_QUERY } from \"../queries/queries\";\n\n\n/**\n * Routes to selected item search result\n * @param item - item\n */\nfunction routeToItem(item) {\n\tRouter.push({\n\t\tpathname: '/item',\n\t\tquery: {\n\t\t\tid: item.id,\n\t\t},\n\t});\n}\n\nclass AutoComplete extends React.Component {\n\tstate = {\n\t\titems: [],\n\t\tloading: false,\n\t};\n\n\t/**\n\t * Handles event changes (debounced by 350ms)\n\t * @param e - event (keyboard input)\n\t * @param client - Apollo client\n\t */\n\tonChange = debounce(async (e, client) => {\n\t\tthis.setState({ loading: true });\n\t\t// manually query Apollo client\n\t\tconst response = await client.query({\n\t\t\tquery: SEARCH_ITEMS_QUERY,\n\t\t\tvariables: {\n\t\t\t\tsearchTerm: e.target.value,\n\t\t\t}\n\t\t});\n\t\tthis.setState({\n\t\t\titems: response.data.items,\n\t\t\tloading: false\n\t\t});\n\t}, 350);\n\n\trender() {\n\t\tresetIdCounter();\n\t\treturn (\n\t\t\t<SearchStyles>\n\t\t\t\t<Downshift onChange={routeToItem} itemToString={item => (item === null ? '' : item.title)}>\n\t\t\t\t\t{({ getInputProps, getItemProps, isOpen, inputValue, highlightedIndex }) => (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<ApolloConsumer>\n\t\t\t\t\t\t\t\t{(client) => (\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype=\"search\"\n\t\t\t\t\t\t\t\t\t\t{...getInputProps({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'search',\n\t\t\t\t\t\t\t\t\t\t\tplaceholder: 'Search for an item',\n\t\t\t\t\t\t\t\t\t\t\tid: 'search',\n\t\t\t\t\t\t\t\t\t\t\tclassName: this.state.loading ? 'loading' : '',\n\t\t\t\t\t\t\t\t\t\t\tonChange: e => {\n\t\t\t\t\t\t\t\t\t\t\t\t// maintain the state of the event, o/w will not have access in debounce\n\t\t\t\t\t\t\t\t\t\t\t\t// (onChange) because it will be gone by the time onChange does stuff to\n\t\t\t\t\t\t\t\t\t\t\t\t// to it\n\t\t\t\t\t\t\t\t\t\t\t\te.persist();\n\t\t\t\t\t\t\t\t\t\t\t\t// Apollo consumer exposes client and when someone types we can pass e to sep function\n\t\t\t\t\t\t\t\t\t\t\t\tthis.onChange(e, client);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</ApolloConsumer>\n\n\t\t\t\t\t\t\t{isOpen && (\n\t\t\t\t\t\t\t\t<DropDown>\n\t\t\t\t\t\t\t\t\t{this.state.items.map((item, index) => (\n\t\t\t\t\t\t\t\t\t\t\t<DropDownItem\n\t\t\t\t\t\t\t\t\t\t\t\t{...getItemProps({ item })}\n\t\t\t\t\t\t\t\t\t\t\t\tkey={item.id}\n\t\t\t\t\t\t\t\t\t\t\t\thighlighted={index === highlightedIndex}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<img width=\"50\" src={item.image} alt={item.title}/>\n\t\t\t\t\t\t\t\t\t\t\t\t{item.title}\n\t\t\t\t\t\t\t\t\t\t\t</DropDownItem>\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t{!this.state.items.length && !this.state.loading && (\n\t\t\t\t\t\t\t\t\t\t<DropDownItem>Nothing found for {inputValue}</DropDownItem>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</DropDown>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</Downshift>\n\t\t\t</SearchStyles>\n\t\t);\n\t}\n}\n\nexport default AutoComplete;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;;;;;AAIA;AACA;AACA;AACA;AACA;AADA;AAFA;AAMA;AACA;AACA;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AAFA;AACA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAHA;AAAA;AAIA;AACA;AACA;AADA;AAFA;AACA;AAJA;AAGA;AACA;AAKA;AACA;AACA;AAFA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;;;;;;AAcA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAZA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAsBA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AAAA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AANA;AAYA;AAAA;AAAA;AAAA;AAAA;AAAA;AAtCA;AA+CA;;;;AA9EA;AACA;AAgFA;;;;A","sourceRoot":""}