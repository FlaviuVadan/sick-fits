{"version":3,"file":"static/webpack/static/development/pages/_app.js.b11138239f3e87532020.hot-update.js","sources":["webpack:///./components/RemoveFromCart.js"],"sourcesContent":["import React from 'react';\nimport { Mutation } from 'react-apollo';\nimport styled from 'styled-components';\nimport PropTypes from 'prop-types';\nimport { CURRENT_USER_QUERY, REMOVE_FROM_CART_MUTATION } from \"../queries/queries\";\n\n\nconst RemoveButton = styled.button`\n\tfont-size: 3rem;\n\tbackground: none;\n\tborder: 0;\n\t\n\t&:hover {\n\t\tcolor: ${props => props.theme.red};\n\t\tcursor: pointer;\n\t}\n`;\n\nclass RemoveFromCart extends React.Component {\n\tstatic propTypes = {\n\t\tid: PropTypes.string.isRequired,\n\t};\n\n\t/**\n\t * Called upon a response from the back-end\n\t * @param cache - Apollo cache\n\t * @param payload - content (item id from resolved mutation)\n\t */\n\tupdate = (cache, payload) => {\n\t\t// read cache\n\t\tconst data = cache.readQuery({ query: CURRENT_USER_QUERY });\n\t\t// remove item from cart\n\t\tconst cartItemId = payload.data.removeFromCart.id;\n\t\t// write back to cache\n\t\tdata.currentUser.cart = data.currentUser.cart.filter(cartItem => cartItem.id !== cartItemId);\n\t\tcache.writeQuery({ query: CURRENT_USER_QUERY, data });\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<Mutation\n\t\t\t\tmutation={REMOVE_FROM_CART_MUTATION}\n\t\t\t\tvariables={{ id: this.props.id }}\n\t\t\t\tupdate={this.update}\n\t\t\t\toptimisticResponse={{\n\t\t\t\t\t__typename: 'Mutation',\n\t\t\t\t\tremoveFromCart: {\n\t\t\t\t\t\tid: this.props.id,\n\t\t\t\t\t}\n\t\t\t\t}}>\n\t\t\t\t{(removeFromCart, { loading }) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<RemoveButton title=\"Remove Item\" disabled={loading}\n\t\t\t\t\t\t\t\t\t  onClick={() => {\n\t\t\t\t\t\t\t\t\t\t  removeFromCart({}).catch(err => alert(err.message));\n\t\t\t\t\t\t\t\t\t  }}>\n\t\t\t\t\t\t\t&times;\n\t\t\t\t\t\t</RemoveButton>\n\t\t\t\t\t);\n\t\t\t\t}}\n\t\t\t</Mutation>\n\t\t);\n\t}\n}\n\nexport default RemoveFromCart;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAGA;AAAA;AAAA;AAAA;AAMA;AAAA;AACA;AAIA;;;;;;;;;;;;;;;;;;AAUA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AADA;AAFA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAGA;;;;AA5CA;AACA;AADA;AAEA;AADA;AACA;AA6CA;;;;A","sourceRoot":""}